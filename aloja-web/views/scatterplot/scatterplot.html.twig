{% extends "layout.html.twig" %}

{% block stylesheet %}
    {{ parent() }}
{% endblock %}

{% block javascript %}
    {{ parent() }}
    {{ highcharts_js|raw }}

    <script>
        $(document).ready(function() {

            $('select').change(function() {
                $(this).parents('form').submit();
            });

            $('#chart').highcharts({
                chart: {
                    type: 'scatter',
                    zoomType: 'xy',
                },
                title: {
                    text: 'Scatterplot'
                },
                subtitle: {
                    text: '{{ jobid }}'
                },
                xAxis: {
                    title: {
                        text: '{{ metricX }}'
                    },
                },
                yAxis: {
                    title: {
                        text: '{{ metricY }}'
                    },
                },
                tooltip: {
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                },
                series: 
                    [
                    {% for serie in series %}
                        {
                            showInLegend: true,
                            name: "Cluster {{ loop.index }}",
                            tooltip: {
                                headerFormat: '',
                                pointFormat: '<span style="font-size: 10px">{point.task}</span><br/><span style="color:{series.color}">\u25CF</span> {{ metricX }}: <b>{point.x}</b><br/><span style="color:{series.color}">\u25CF</span> {{ metricY }}: <b>{point.y}</b><br/>',
                            },
                            data: [
                                {{ serie | raw }}
                            ],
                        },
                    {% endfor %}
                    {% if noise is not empty %}
                        {
                            showInLegend: true,
                            name: "Noise",
                            tooltip: {
                                headerFormat: '',
                                pointFormat: '<span style="font-size: 10px">{point.task}</span><br/><span style="color:{series.color}">\u25CF</span> {{ metricX }}: <b>{point.x}</b><br/><span style="color:{series.color}">\u25CF</span> {{ metricY }}: <b>{point.y}</b><br/>',
                            },
                            data: [
                                {{ noise | raw }}
                            ],
                        },
                    {% endif %}
                    ]
            });
        });
    </script>
{% endblock %}

{% block navigation %}
    {{ parent() }}

    <div id="navigation" style="text-align: center;">
        <h1>Histogram</h1>
        <div id="filters" style="text-align: left;">
            <form method="GET">
                <input type="hidden" name="jobid" value="{{ jobid }}">
                <strong>Metric X: </strong>
                <select name="metricX">
                    {% for current_metric in METRICS %}
                        <option value="{{ loop.index0 }}" {% if current_metric == metricX %}selected="selected"{% endif %}>{{ current_metric }}</option>
                    {% endfor %}
                </select>
                &nbsp;&nbsp;&nbsp;
                <strong>Metric Y: </strong>
                <select name="metricY">
                    {% for current_metric in METRICS %}
                        <option value="{{ loop.index0 }}" {% if current_metric == metricY %}selected="selected"{% endif %}>{{ current_metric }}</option>
                    {% endfor %}
                </select>
                &nbsp;&nbsp;&nbsp;
                <strong>Ems: </strong>
                <input type="text" name="eps" value="{{ eps }}" size="4">
                &nbsp;&nbsp;&nbsp;
                <strong>MinPoints: </strong>
                <input type="text" name="minPoints" value="{{ minPoints }}" size="4">
            </form>
        </div>
        <div id="chart" style="margin: 0 auto"></div>
    </div>

{% endblock %}
